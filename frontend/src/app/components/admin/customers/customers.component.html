<div class="button-wrapper shadow"></div>
<div class="wrapper" *ngIf="gridOptions">
  <div class="table-control">
    <app-column-search-filter
      width="200px"
      [type]="type"
      [(filterColumns)]="filterColumns"
      (filterColumnsChange)="filterColumnsChange()"
      [(searchColumns)]="searchColumns"
      (searchColumnsChange)="searchColumnsChange()"
    >
    </app-column-search-filter>
  </div>
  <div class="table theme-table">
    <div class="mb-2 d-flex align-items-center justify-content-end">
      <div class="search-box d-flex align-items-center">
        <input
          class="mr-3"
          placeholder="Customer Name"
          [(ngModel)]="searchQuery"
          (ngModelChange)="searchDebouncer.next()"
        />
        <span class="text-theme" *ngIf="!(searchQuery?.length > 3)">
          <i class="fa fa-search"></i>
        </span>
        <span
          class=" text-theme clear-query"
          *ngIf="searchQuery?.length > 3"
          (click)="searchQuery = ''; searchDebouncer.next()"
        >
          <i class="fa fa-times"></i>
        </span>
      </div>

      <span class="text-dark-blue font-sm text-right w-100">total: {{ totalcounts }}</span>
    </div>
    <ag-grid-angular
      style="width: 100%; height: 100%;"
      class="ag-theme-balham"
      [rowData]="rowData"
      (gridReady)="onGridReady($event)"
      rowModelType="infinite"
      [gridOptions]="gridOptions"
      [cacheBlockSize]="pageSize"
    >
    </ag-grid-angular>
    <ngx-spinner
      [name]="'spooler'"
      bdColor="#ffffff80"
      size="small"
      color="#74bf09"
      type="ball-clip-rotate"
      [fullScreen]="false"
    >
      <p class="m-0">Loading...</p>
    </ngx-spinner>
  </div>
</div>

<ng-template #actionControl let-row>
  <div class="d-flex w-100 h-100 justify-content-between controls">
    <!-- <span class="text-theme-green" (click)="onView(row)">View</span> -->
    <span class="text-purple" *ngIf="row && row.userLocked" (click)="onUnlock(row)">Unlock</span>
    <span class="text-theme-green" *ngIf="row && !row.userActive" (click)="onActivate(row)">Activate</span>
    <span class="text-orange" *ngIf="row && row.userActive" (click)="onDeactivate(row)">Deactivate</span>
  </div>
</ng-template>

<!-- Subscription cell -->
<ng-template #subscriptionCell let-row>
  <div>
    <span class="subscription-cell" *ngIf="row && row.userActive" (click)="subscription($event, row)"
      >Subscription</span
    >
  </div>
</ng-template>

<ng-template #subscriptionModal let-modal>
  <app-subscription-modal
    [subscriptions]="subscriptions"
    [addons]="addons"
    [contractInfo]="contractInfo"
    (cancel)="modal.dismiss()"
    (ok)="setSubscription($event)"
  ></app-subscription-modal>
</ng-template>

<!-- Subscription cell -->
<ng-template #linkVendorCell let-row>
  <div>
    <span class="link-cell" *ngIf="row && row.userActive" (click)="link($event, row)">
      Link Vendor
    </span>
  </div>
</ng-template>

<ng-template #linkVendorModal let-modal>
  <app-approve-vendor [inModal]="true" [customerId]="customerId"></app-approve-vendor>
</ng-template>
