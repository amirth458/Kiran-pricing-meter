<div class="wrapper">
  <div class="d-flex flex-column w-100 table theme-table">
    <div class="d-flex header justify-content-between align-items-center">
      <app-rfq-filter [placeholder]="placeholderText" (formChange)="filter$.next($event)"></app-rfq-filter>
    </div>
    <div class="ag-theme-balham w-100 h-100 position-relative">
      <ag-grid-angular
        class="ag-theme-balham w-100 h-100"
        [gridOptions]="gridOptions"
        (gridReady)="onGridReady($event)"
      >
      </ag-grid-angular>
      <ngx-spinner
        [name]="'loadingPanel'"
        bdColor="#ffffff70"
        size="small"
        color="#74bf09"
        type="ball-clip-rotate"
        [fullScreen]="false"
      >
        <p class="m-0">Loading...</p>
      </ngx-spinner>
    </div>
  </div>
</div>

<ng-template #reportsActions let-row>
  <div class="text-theme-green d-flex justify-content-between">
    <button (click)="onDownload(row)" class="btn theme btn-select mr-2" type="button">
      Download Files
    </button>
    <button (click)="onUpload(row)" class="btn theme btn-select orange-btn mr-2" type="button">
      Upload Reports
    </button>
    <button (click)="onView(row)" class="btn theme blue btn-select" type="button">
      View
    </button>
  </div>
</ng-template>

<ng-template #uploadReports let-modal let-row>
  <div class="upload-modal p-4">
    <ngb-tabset [destroyOnHide]="false">
      <ngb-tab *ngFor="let part of parts">
        <ng-template ngbTabTitle>{{ part.id }}</ng-template>
        <ng-template ngbTabContent>
          <div class="reports px-4 py-2 text-theme">
            <div *ngFor="let report of part.details" class="report my-2 d-flex justify-content-between">
              <span class="text-theme-green font-md">
                {{ report.name }}
                <a class="ml-3" [href]="report?.reportUrl" target="_blank" *ngIf="report?.reportUrl">
                  <span class="text-theme-green cursor-pointer">
                    <i class="fa fa-download"></i>
                  </span>
                </a>
              </span>
              <div class="upload-btn">
                <input
                  class="font-md file-input"
                  type="file"
                  (change)="onFileSelected($event, part.order.id, part.id, report.reportSettingId)"
                />
              </div>
            </div>

            <div class="actions p-4 d-flex justify-content-center">
              <button type="button" (click)="model.close()" class="btn theme whitee w-25 mr-1">
                Cancel
              </button>

              <button
                [disabled]="!canSubmitReport()"
                type="button"
                (click)="submitReports()"
                class="btn theme ml-1 w-25 "
              >
                Upload Reports
              </button>
            </div>
          </div>
        </ng-template>
      </ngb-tab>
    </ngb-tabset>
  </div>
</ng-template>
